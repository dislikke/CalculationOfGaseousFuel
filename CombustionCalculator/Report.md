# Отчет по курсовой работе
## Разработка программного обеспечения для расчета температур горения топлива

### Содержание
1. [Введение](#введение)
2. [Анализ предметной области](#анализ-предметной-области)
3. [Проектирование программного обеспечения](#проектирование-программного-обеспечения)
4. [Реализация программного обеспечения](#реализация-программного-обеспечения)
5. [Тестирование и отладка](#тестирование-и-отладка)
6. [Заключение](#заключение)

### Введение
Данная курсовая работа посвящена разработке программного обеспечения для расчета температур горения топлива. Программа предназначена для автоматизации сложных теплотехнических расчетов, которые необходимы в металлургической промышленности.

#### Цель работы
Разработать программное обеспечение, позволяющее:
- Производить расчет температур горения топлива (t0, t0б, ta, taб)
- Выполнять расчет объемов воздуха и продуктов сгорания
- Определять теплоту сгорания и энтальпию
- Визуализировать результаты расчетов в виде графиков

#### Задачи работы
1. Анализ предметной области и существующих решений
2. Проектирование архитектуры программного обеспечения
3. Реализация программного продукта
4. Тестирование и отладка программы
5. Документирование результатов работы

### Анализ предметной области
В металлургической промышленности важную роль играет точный расчет температур горения топлива. Эти расчеты необходимы для:
- Оптимизации процессов горения
- Контроля температурных режимов
- Повышения энергоэффективности производства
- Снижения вредных выбросов

#### Существующие решения
Большинство существующих решений представляют собой:
- Табличные расчеты в Excel
- Устаревшее программное обеспечение
- Ручные расчеты по справочникам

Недостатки существующих решений:
- Низкая точность
- Отсутствие автоматизации
- Сложность использования
- Отсутствие визуализации результатов

### Проектирование программного обеспечения

#### Архитектура программы
Программа разработана с использованием объектно-ориентированного подхода и состоит из следующих основных компонентов:

1. **Form1** - главная форма приложения
   - Пользовательский интерфейс
   - Обработка событий
   - Координация работы других компонентов

2. **TemperatureTable** - класс для работы с таблицами температур
   - Хранение табличных данных
   - Методы интерполяции
   - Расчет температур

3. **CombustionCalculator** - класс для расчетов горения
   - Расчет объемов воздуха
   - Расчет продуктов сгорания
   - Расчет теплоты сгорания
   - Расчет энтальпии

4. **ChartForm** - форма для отображения графиков
   - Визуализация результатов
   - Построение графиков зависимостей
   - Отображение расчетных точек

#### Используемые технологии
- Язык программирования: C#
- Платформа: .NET Framework
- GUI Framework: Windows Forms
- Библиотеки: System.Windows.Forms.DataVisualization

### Реализация программного обеспечения

#### Структура программы
Программа реализована на языке C# с использованием Windows Forms и состоит из следующих основных компонентов:

1. **Главная форма (Form1)**
   - Содержит элементы пользовательского интерфейса для ввода данных:
     * Текстовые поля для ввода состава топлива (CO, H2, CH4, C2H6 и др.)
     * Поля для ввода параметров процесса (влагосодержание, коэффициент избытка воздуха)
     * Поля для ввода температур топлива и воздуха
   - Реализует обработку событий:
     * Кнопка расчета (btnCalculate_Click)
     * Кнопка очистки (btnClear_Click)
     * Кнопка построения графика (bttChart_Click)
     * Кнопка экспорта в CSV (button1_Click)

2. **Класс для работы с таблицами температур (TemperatureTable)**
   - Содержит статические таблицы данных:
     * EnthalpyTable_LowQnB - для низкой теплоты сгорания (Qn <= 8400)
     * EnthalpyTable_HighQnB - для высокой теплоты сгорания (Qn > 12500)
     * EnthalpyTable_LowQn - для основных расчетов при низкой теплоте
     * EnthalpyTable_HighQn - для основных расчетов при высокой теплоте
   - Реализует методы интерполяции:
```csharp
public static double InterpolateTemperatureByEnthalpy(
    double targetEnthalpy,
    double VL,
    Dictionary<int, (double[] Temperatures, double[] Enthalpies)> enthalpyTable)
{
    // Находит температуру по заданной энтальпии с учетом влагосодержания
    // Использует двойную интерполяцию
}

private static double InterpolateForEnthalpy(
    double targetEnthalpy,
    double[] enthalpyValues,
    double[] temperatureValues)
{
    // Выполняет линейную интерполяцию для нахождения температуры
}
```

3. **Калькулятор горения (CombustionCalculator)**
   - Методы расчета объемов воздуха:
```csharp
public static double CalculateVO2(InputData d)
{
    // Расчет теоретически необходимого объема кислорода
    return 0.01 * (
        0.5 * d.CO +
        0.5 * d.H2 +
        1.5 * d.H2S +
        2.0 * d.CH4 +
        3.5 * d.C2H6 +
        5.0 * d.C3H8 +
        6.5 * d.C4H10 +
        8.0 * d.C5H12 +
        3.0 * d.C2H2 +
        2.5 * d.C2H4 -
        d.O2
    );
}

public static double CalculateL0(double VO2)
{
    // Расчет теоретически необходимого объема воздуха
    return (1 + 3.762) * VO2;
}
```
   - Методы расчета продуктов сгорания:
```csharp
public static double CalculateV0CO2(InputData d)
{
    // Расчет объема углекислого газа
    return 0.01 * (
        d.CO2 + d.CO + d.CH4 +
        2 * d.C2H6 +
        3 * d.C3H8 +
        4 * d.C4H10 +
        5 * d.C5H12 +
        2 * d.C2H2 +
        2 * d.C2H4
    );
}
```
   - Методы расчета энтальпии:
```csharp
public static double CalculateITGeneral(
    double alpha, double La, double Qn,
    double VaTotal, double LaWet,
    double cpDryAir, double tempAir,
    double cpFuel, double tempFuel)
{
    // Расчет общей энтальпии с учетом всех параметров
}
```

4. **Форма графиков (ChartForm)**
   - Визуализация результатов:
     * Построение графиков зависимости энтальпии от температуры
     * Отображение точек расчета (t0, t0б, ta, taб)
   - Методы построения графиков:
```csharp
private void PlotFullChart(Chart chart, double Qn)
{
    // Построение полного графика с учетом теплоты сгорания
}

private void AddCalculatedPoints(
    double t0, double t0b, double ta,
    double tab, double VL,
    double iT0, double iT0b,
    double iTa, double iTab)
{
    // Добавление расчетных точек на график
}
```

#### Алгоритм работы программы

1. **Ввод данных**
   - Пользователь вводит состав топлива
   - Задает параметры процесса
   - Указывает температуры топлива и воздуха

2. **Расчет параметров горения**
   - Расчет объемов воздуха (VO2, L0, La)
   - Расчет объемов продуктов сгорания
   - Определение влагосодержания
   - Расчет теплоты сгорания

3. **Расчет энтальпий**
   - Расчет iT0 и iT0б для α=1
   - Расчет iTa и iTab для заданного α
   - Учет температур топлива и воздуха
   - Учет теплоемкостей

4. **Определение температур**
   - Выбор таблицы в зависимости от теплоты сгорания
   - Интерполяция для нахождения температур
   - Проверка корректности результатов

5. **Вывод результатов**
   - Отображение рассчитанных температур
   - Вывод промежуточных результатов
   - Построение графиков
   - Возможность экспорта в CSV

#### Система логирования и отладки

В программе реализована подробная система логирования:
```csharp
private static void Log(string message)
{
    Debug.WriteLine(message);
    File.AppendAllText("temperature_debug.log", message + Environment.NewLine);
    System.Diagnostics.Debug.WriteLine(message);
}
```

Логирование включает:
- Входные параметры расчетов
- Промежуточные результаты
- Процесс интерполяции
- Ошибки и исключения

### Тестирование и отладка

#### Методы тестирования
1. Модульное тестирование
   - Проверка отдельных методов расчета
   - Тестирование граничных условий
   - Проверка обработки ошибок

2. Интеграционное тестирование
   - Взаимодействие между компонентами
   - Корректность передачи данных
   - Согласованность результатов

3. Системное тестирование
   - Проверка всего функционала
   - Тестирование пользовательского интерфейса
   - Проверка производительности

#### Отладка
В программе реализована система логирования, которая помогает:
- Отслеживать ход вычислений
- Находить ошибки в расчетах
- Контролировать корректность входных данных

### Заключение

В результате выполнения курсовой работы:
1. Разработано программное обеспечение для расчета температур горения топлива
2. Реализован удобный пользовательский интерфейс
3. Внедрена система визуализации результатов
4. Обеспечена высокая точность расчетов
5. Создана система логирования и отладки

#### Достигнутые результаты
- Автоматизация сложных теплотехнических расчетов
- Повышение точности вычислений
- Сокращение времени на проведение расчетов
- Удобная визуализация результатов

#### Перспективы развития
1. Добавление новых видов топлива
2. Расширение функционала визуализации
3. Реализация экспорта данных в различные форматы
4. Создание веб-версии приложения 